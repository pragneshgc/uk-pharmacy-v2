import{_ as w,P as D,o as s,h as E,j as T,c as i,a as e,t as p,w as f,A as y,F as g,f as b,b as a,B as C,T as A,G as S,E as B,H as L,e as P,g as U,m as k,n as V}from"./app-82NRaNNR.js";import{l as N}from"./logging-D8Y4Ru6_.js";const F={mixins:[D],data:function(){return{userInfo,productCodeId:!1,productCode:{},productCodeEdit:{},pricingId:!1,errors:[],options:[],list:[],clients:[],countries:[],editing:!1,type:"product",form:{country:{price:!1,country:!1},pricing:{price:!1,client:0},product:{}},saving:!1,callback:!1,callbackData:!1,buttonText:!1,override:!1,visible:!1}},computed:{saveButtonText(){return this.buttonText?this.buttonText:!this.productCodeId&&this.editing?"Add":this.pricingId&&this.editing?"Update":"Save Changes"},title(){return this.editing&&this.productCodeId?"Edit Product":this.editing&&!this.productCodeId?"Create Product":"Product List"}},mounted(){this.emitter.on("label.details",this.getProductDetails),this.emitter.on("label.add",this.addProduct),this.clear()},beforeDestroy(){this.emitter.off("product.details",this.getProductDetails),this.emitter.off("product.add"),$("#productEditor").off("hidden.bs.modal")},watch:{productCodeId(){this.getPriceList(),this.getProductCode()},type(t){t=="country"&&this.getCountries()}},methods:{getProductDetails(t){this.productCode=t,this.editing=!1,this.type="product",this.productCodeId=this.productCode.ProductCodeID,this.show()},show(){this.options.length==0&&this.getOptions(),this.visible=!0},getCountries(){axios.get("/countries").then(t=>{this.countries=t.data.data}).catch(t=>{console.log(t)})},getOptions(){axios.get("/inventory/products/list").then(t=>{this.options=t.data.data}).catch(t=>{console.log(t)})},getPriceList(){axios.get(`/inventory/products/${this.productCodeId}/list`).then(t=>{this.list=t.data.data}).catch(t=>{console.log(t)})},getDeliveryCompanies(t=!1){axios.get("/inventory/delivery/list").then(o=>{this.deliveryCompanies=o.data.data,t&&t()}).catch(o=>{console.log(o)})},getClients(t=!1){axios.get("/inventory/clients/list").then(o=>{this.clients=o.data.data,t&&t()}).catch(o=>{console.log(o)})},getProductCode(){axios.get(`/inventory/products/${this.productCodeId}`).then(t=>{this.productCode=t.data.data}).catch(t=>{console.log(t)})},addProduct(){this.editing=!0,this.type="product",this.productCodeId=!1,this.show()},addCountry(){this.editing=!0,this.type="country",this.productCodeId=!1,this.show()},removePricing(t){this.$swal({title:"Are you sure you want to remove this pricing?",text:"This cannot be reverted!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, remove it!"}).then(o=>{o.value&&axios.delete(`/inventory/products/pricing/${t}`).then(d=>{this.$swal({title:"Pricing removed",type:"error",showConfirmButton:!0}),this.getPriceList()}).catch(d=>{console.log(d)})})},deleteProduct(){this.$swal({title:"Are you sure you want to deactivate this product?",text:"This can be reverted",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, deactivate it!"}).then(t=>{t.value&&axios.delete(`/inventory/products/${this.productCodeId}/delete`).then(o=>{this.$swal({title:"Product has been deactivated",type:"error",showConfirmButton:!0}),this.getProductCode(),this.emitter.emit("product.refresh")}).catch(o=>{console.log(o)})})},reactivateProduct(){this.$swal({title:"Are you sure you want to activate this product?",text:"This can be reverted",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, deactivate it!"}).then(t=>{t.value&&axios.post(`/inventory/products/${this.productCodeId}/reactivate`).then(o=>{this.$swal({title:"Product has been reactivated",type:"success",showConfirmButton:!0}),this.getProductCode(),this.emitter.emit("product.refresh")}).catch(o=>{console.log(o)})})},save(){if(!this.productCodeId&&this.type=="country")axios.post("/inventory/countries/pricing",this.form.country).then(t=>{this.$swal({title:"Default pricing for country added",type:"success",showConfirmButton:!0}),this.emitter.emit("product.refresh"),this.clear()}).catch(t=>{console.log(t)});else if(!this.pricingId&&this.type=="pricing"&&this.editing){let t={pricing:this.form.pricing,productCode:this.productCode};axios.post("/inventory/products/pricing",t).then(o=>{this.$swal({title:"Pricing for country added",type:"success",showConfirmButton:!0}),this.emitter.emit("product.refresh"),this.back()}).catch(o=>{console.log(o)})}else this.pricingId&&(this.type=="country"||this.type=="product")?axios.patch(`/inventory/countries/pricing/${this.pricingId}`,this.form.country).then(t=>{this.$swal({title:"Pricing updated",type:"success",showConfirmButton:!0}),this.back()}).catch(t=>{console.log(t)}):this.productCodeId&&this.type=="product"?axios.patch(`/inventory/products/${this.productCodeId}`,this.productCodeEdit).then(t=>{this.$swal({title:"Product updated",type:"success",showConfirmButton:!0}),this.emitter.emit("product.refresh"),this.getOptions(),this.back()}).catch(t=>{this.errors=t.response.data.errors}):!this.productCodeId&&this.type=="product"&&axios.post("/inventory/products",this.productCodeEdit).then(t=>{this.$swal({title:"Product added",type:"success",showConfirmButton:!0}),this.emitter.emit("product.refresh"),this.clear()}).catch(t=>{this.errors=t.response.data.errors})},back(){let t=JSON.parse(JSON.stringify(this.productCodeId));this.clear(!1),this.productCodeId=t,this.getProductCode(),this.getPriceList(),this.editing=!1},edit(t){this.editing=!0,this.productCode.Type==2?this.type="country":this.type="product",this.form.country.country=t.Code,this.form.country.price=t.UnformattedPrice,this.pricingId=t.PricingID},editProduct(t=!1){this.editing=!0,this.type="product",this.productCodeEdit=JSON.parse(JSON.stringify(this.productCode))},addPricing(){this.clients.length==0?this.getClients(()=>{this.editing=!0,this.type="pricing"}):(this.editing=!0,this.type="pricing")},clear(t=!0){t&&(this.visible=!1),this.form={country:{price:!1,country:!1},pricing:{price:!1,client:!1},product:{}},this.editing=!1,this.productCodeId=!1,this.productCodeEdit={},this.pricingId=!1,this.errors=[]},checkFields(t){if(this.override){t();return}this.selectedItem.FMDExpiryDate==""||this.selectedItem.FMDExpiryDate==null||!/[\d]{2}\/[\d]{4}/.test(this.selectedItem.FMDExpiryDate)?this.errors.FMDExpiryDate=!0:this.errors.FMDExpiryDate=!1,this.errors.FMDBatchID=this.selectedItem.FMDBatchID==""||this.selectedItem.FMDBatchID==null,!this.errors.FMDExpiryDate&&!this.errors.FMDBatchID&&t()},setOptions(t){t?(this.callback=t.callback?t.callback:!1,this.callbackData=t.callbackData?t.callbackData:!1,this.buttonText=t.text?t.text:!1):(this.callback=!1,this.callbackData=!1,this.buttonText=!1)}}},O={key:0,class:"esa-modal",id:"productEditor",tabindex:"-1",role:"dialog","aria-labelledby":"itemEditorLabel","aria-modal":"true"},x={class:"modal",role:"document"},G={class:"modal-header"},M={class:"heading lead"},z={key:0,class:"modal-header",style:{background:"transparent","box-shadow":"none","border-bottom":"1px solid gainsboro",display:"flex","align-items":"center"}},Q=e("option",{value:""},"SELECT",-1),H=["value"],Y={class:"modal-body text-center"},J={class:"expand-100 d-flex justify-content-between"},j={class:"row wow fadeIn",style:{width:"100%"}},R={key:0,class:"col-lg-12 wow fadeIn"},W={key:0,id:"products-table",class:"table table-hover"},K={class:"primary-color text-white"},X=e("th",null," Options ",-1),Z=["onClick"],q=e("i",{class:"fa fa-edit",style:{color:"white"}},null,-1),tt=[q],et=["onClick"],ot=e("i",{class:"fa fa-trash",style:{color:"white"}},null,-1),st=[ot],it={key:1,class:"pxp-form"},rt={class:"form-column"},dt={class:"form-group form-group-2"},nt=e("label",{for:"CountryID"},"Select Country",-1),lt=["value"],at={class:"form-column"},ct={class:"form-group form-group-2"},ut=e("label",{for:"Price"},"Price",-1),pt={key:2,class:"pxp-form"},ht={class:"form-column"},ft={class:"form-group form-group-2"},mt=e("label",{for:"Price"},"Price",-1),gt={key:3,class:"pxp-form wow fadeIn"},bt={class:"form-column"},yt={class:"form-group form-group-2"},Ct=e("label",{for:"ClientID"},"Client",-1),_t=e("option",{value:0},"DEFAULT",-1),vt=["value"],kt={class:"form-column"},It={class:"form-group form-group-2"},Pt=e("label",{for:"Price"},"Price",-1),wt={key:4,class:"pxp-form wow fadeIn"},Dt={class:"form-column"},$t={class:"form-group form-group-2"},Et=e("label",{for:"code"},"Code",-1),Tt=e("label",{for:"code"},"CAUTION : changing this will affect pricing",-1),At={key:0,class:"invalid-feedback d-block"},St={class:"form-group form-group-2"},Bt=e("label",{for:"name"},"Name",-1),Lt={key:0,class:"invalid-feedback d-block"},Ut={class:"form-group form-group-2"},Vt=e("label",{for:"Quantity"},"Quantity",-1),Nt=e("label",{for:"Quantity"},"CAUTION : changing this will affect pricing",-1),Ft={key:0,class:"invalid-feedback d-block"},Ot={class:"form-group form-group-2"},xt=e("label",{for:"Units"},"Units",-1),Gt={key:0,class:"invalid-feedback d-block"},Mt={class:"form-group form-group-2"},zt=e("label",{for:"TariffCode"},"Tariff Code",-1),Qt={key:0,class:"invalid-feedback d-block"},Ht={class:"form-group form-group-2"},Yt=e("label",{for:"Fridge"},"Fridge",-1),Jt={key:0,value:null},jt={key:1,value:"0",selected:""},Rt={key:2,value:"1"},Wt={key:0,class:"invalid-feedback d-block"},Kt={class:"form-column"},Xt={class:"form-group form-group-2"},Zt=e("label",{for:"ProductType"},"Product Type",-1),qt=e("option",{value:"1",selected:""},"Medicine",-1),te=e("option",{value:"2"},"Test Kit",-1),ee=[qt,te],oe={key:0,class:"invalid-feedback d-block"},se={class:"form-group form-group-2"},ie=e("label",{for:"OTC"},"Reclassification",-1),re=e("option",{value:"0",selected:""},"POM",-1),de=e("option",{value:"1"},"p",-1),ne=[re,de],le={key:0,class:"invalid-feedback d-block"},ae={class:"form-group form-group-2"},ce=e("label",{for:"Pack"},"Pack",-1),ue=e("option",{value:"0",selected:""},"No",-1),pe=e("option",{value:"1"},"Yes",-1),he=[ue,pe],fe={key:0,class:"invalid-feedback d-block"},me={class:"form-group form-group-2"},ge=e("label",{for:"Status"},"Status",-1),be=e("option",{value:"1",selected:""},"Active",-1),ye=e("option",{value:"0"},"Inactive",-1),Ce=e("option",{value:"2"},"Discontinued",-1),_e=[be,ye,Ce],ve={key:0,class:"invalid-feedback d-block"},ke={class:"form-group form-group-2"},Ie=e("label",{for:"VAT"},"VAT %",-1),Pe=e("option",{value:"",disabled:""},"Please select VAT value",-1),we=e("option",{value:"0",selected:""},"0.00%",-1),De=e("option",{value:"5"},"5.00%",-1),$e=e("option",{value:"20"},"20.00%",-1),Ee=[Pe,we,De,$e],Te={key:0,class:"invalid-feedback d-block"},Ae={class:"modal-footer"},Se=["disabled"],Be=["disabled"],Le=["disabled"],Ue=["disabled"];function Ve(t,o,d,h,u,l){return s(),E(A,{name:"fade"},{default:T(()=>[t.visible?(s(),i("div",O,[e("div",{class:"backdrop",onClick:o[0]||(o[0]=r=>l.clear())}),e("div",x,[e("div",G,[e("h3",M,p(l.title),1),e("span",{class:"close",onClick:o[1]||(o[1]=r=>l.clear())},"X")]),t.productCodeId&&!t.pricingId&&!t.editing?(s(),i("div",z,[e("button",{onClick:o[2]||(o[2]=r=>l.editProduct(t.productCode)),class:"btn btnSize02 tertiaryBtn"}," Update Product Code "),f(e("select",{class:"ml-10 browser-default custom-select","onUpdate:modelValue":o[3]||(o[3]=r=>t.productCodeId=r),name:"ProductCodeID"},[Q,(s(!0),i(g,null,b(t.options,r=>(s(),i("option",{key:r.ProductCodeID,value:r.ProductCodeID},p(r.Name),9,H))),128))],512),[[y,t.productCodeId]]),t.productCode.Status==1?(s(),i("button",{key:0,onClick:o[4]||(o[4]=r=>l.deleteProduct()),class:"ml-10 btn btnSize02 tertiaryBtn"}," DEACTIVATE ProductCode ")):(s(),i("button",{key:1,onClick:o[5]||(o[5]=r=>l.reactivateProduct()),class:"ml-10 btn btnSize02 tertiaryBtn"}," ACTIVATE ProductCode "))])):a("",!0),e("div",Y,[e("div",J,[e("div",j,[t.productCodeId&&!t.pricingId&&!t.editing?(s(),i("div",R,[t.list.length>0?(s(),i("table",W,[e("thead",K,[["UnformattedPrice","PricingID"].includes(t.key)?a("",!0):(s(!0),i(g,{key:0},b(t.list[0],(r,v)=>(s(),i("th",{key:v},p(v),1))),128)),X]),e("tbody",null,[(s(!0),i(g,null,b(t.list,r=>(s(),i("tr",{key:r.Code},[["UnformattedPrice","PricingID"].includes(t.k)?a("",!0):(s(!0),i(g,{key:0},b(r,(v,c)=>(s(),i("td",{key:c},p(v),1))),128)),e("td",null,[e("button",{onClick:v=>l.edit(r),class:"table-icon"},tt,8,Z),r.ClientID!="DEFAULT"?(s(),i("button",{key:0,onClick:v=>l.removePricing(r.PricingID),class:"table-icon"},st,8,et)):a("",!0)])]))),128))])])):a("",!0)])):!t.productCodeId&&t.type=="country"?(s(),i("div",it,[e("div",rt,[e("div",dt,[nt,f(e("select",{class:"browser-default custom-select","onUpdate:modelValue":o[6]||(o[6]=r=>t.form.country.country=r),name:"CountryID"},[(s(!0),i(g,null,b(t.countries,r=>(s(),i("option",{key:r.CountryID,value:r.CountryID},p(r.Name),9,lt))),128))],512),[[y,t.form.country.country]])])]),e("div",at,[e("div",ct,[ut,f(e("input",{name:"Price","onUpdate:modelValue":o[7]||(o[7]=r=>t.form.country.price=r),autocomplete:"off",type:"number",id:"value",placeholder:"Default Price",class:"form-control"},null,512),[[C,t.form.country.price]])])])])):t.pricingId&&t.editing?(s(),i("div",pt,[e("div",ht,[e("div",ft,[mt,f(e("input",{name:"Price","onUpdate:modelValue":o[8]||(o[8]=r=>t.form.country.price=r),autocomplete:"off",type:"number",id:"value",placeholder:"Price",class:"form-control"},null,512),[[C,t.form.country.price]])])])])):t.type=="pricing"&&t.editing?(s(),i("div",gt,[e("div",bt,[e("div",yt,[Ct,f(e("select",{class:"browser-default custom-select","onUpdate:modelValue":o[9]||(o[9]=r=>t.form.pricing.client=r),name:"ClientID"},[_t,(s(!0),i(g,null,b(t.clients,r=>(s(),i("option",{key:r.ClientID,value:r.ClientID},p(r.CompanyName),9,vt))),128))],512),[[y,t.form.pricing.client]])])]),e("div",kt,[e("div",It,[Pt,f(e("input",{name:"Price","onUpdate:modelValue":o[10]||(o[10]=r=>t.form.pricing.price=r),autocomplete:"off",type:"number",id:"value",placeholder:"Price",class:"form-control"},null,512),[[C,t.form.pricing.price]])])])])):t.type=="product"&&t.editing?(s(),i("div",wt,[e("div",Dt,[e("div",$t,[Et,f(e("input",{"onUpdate:modelValue":o[11]||(o[11]=r=>t.productCodeEdit.Code=r),type:"text",id:"code",class:"form-control mb-3",placeholder:"Code"},null,512),[[C,t.productCodeEdit.Code]]),Tt,t.errors.Code?(s(),i("div",At,p(t.errors.Code[0]),1)):a("",!0)]),e("div",St,[Bt,f(e("input",{"onUpdate:modelValue":o[12]||(o[12]=r=>t.productCodeEdit.Name=r),type:"text",id:"name",class:"form-control mb-3",placeholder:"Name"},null,512),[[C,t.productCodeEdit.Name]]),t.errors.Name?(s(),i("div",Lt,p(t.errors.Name[0]),1)):a("",!0)]),e("div",Ut,[Vt,f(e("input",{"onUpdate:modelValue":o[13]||(o[13]=r=>t.productCodeEdit.Quantity=r),type:"text",id:"Quantity",class:"form-control mb-3",placeholder:"Quantity"},null,512),[[C,t.productCodeEdit.Quantity]]),Nt,t.errors.Quantity?(s(),i("div",Ft,p(t.errors.Quantity[0]),1)):a("",!0)]),e("div",Ot,[xt,f(e("input",{"onUpdate:modelValue":o[14]||(o[14]=r=>t.productCodeEdit.Units=r),type:"text",id:"Units",class:"form-control mb-3",placeholder:"Units"},null,512),[[C,t.productCodeEdit.Units]]),t.errors.Units?(s(),i("div",Gt,p(t.errors.Units[0]),1)):a("",!0)]),e("div",Mt,[zt,f(e("input",{"onUpdate:modelValue":o[15]||(o[15]=r=>t.productCodeEdit.TariffCode=r),type:"text",id:"TariffCode",class:"form-control mb-3",placeholder:"Tariff Code"},null,512),[[C,t.productCodeEdit.TariffCode]]),t.errors.TariffCode?(s(),i("div",Qt,p(t.errors.TariffCode[0]),1)):a("",!0)]),e("div",Ht,[Yt,f(e("select",{class:"browser-default custom-select","onUpdate:modelValue":o[16]||(o[16]=r=>t.productCodeEdit.Fridge=r),name:"Fridge"},[t.productCodeEdit.Units=="SHIPPING"?(s(),i("option",Jt,"NOT APPLICABLE")):a("",!0),t.productCodeEdit.Units!="SHIPPING"?(s(),i("option",jt,"No ")):a("",!0),t.productCodeEdit.Units!="SHIPPING"?(s(),i("option",Rt,"Yes")):a("",!0)],512),[[y,t.productCodeEdit.Fridge]]),t.errors.Fridge?(s(),i("div",Wt,p(t.errors.Fridge[0]),1)):a("",!0)])]),e("div",Kt,[e("div",Xt,[Zt,f(e("select",{class:"browser-default custom-select","onUpdate:modelValue":o[17]||(o[17]=r=>t.productCodeEdit.ProductType=r),name:"ProductType"},ee,512),[[y,t.productCodeEdit.ProductType]]),t.errors.ProductType?(s(),i("div",oe,p(t.errors.ProductType[0]),1)):a("",!0)]),e("div",se,[ie,f(e("select",{class:"browser-default custom-select","onUpdate:modelValue":o[18]||(o[18]=r=>t.productCodeEdit.OTC=r),name:"OTC"},ne,512),[[y,t.productCodeEdit.OTC]]),t.errors.OTC?(s(),i("div",le,p(t.errors.OTC[0]),1)):a("",!0)]),e("div",ae,[ce,f(e("select",{class:"browser-default custom-select","onUpdate:modelValue":o[19]||(o[19]=r=>t.productCodeEdit.Pack=r),name:"Pack"},he,512),[[y,t.productCodeEdit.Pack]]),t.errors.Pack?(s(),i("div",fe,p(t.errors.Pack[0]),1)):a("",!0)]),e("div",me,[ge,f(e("select",{class:"browser-default custom-select","onUpdate:modelValue":o[20]||(o[20]=r=>t.productCodeEdit.Status=r),name:"Status"},_e,512),[[y,t.productCodeEdit.Status]]),t.errors.Status?(s(),i("div",ve,p(t.errors.Status[0]),1)):a("",!0)]),e("div",ke,[Ie,f(e("select",{class:"browser-default custom-select","onUpdate:modelValue":o[21]||(o[21]=r=>t.productCodeEdit.VAT=r),name:"VAT"},Ee,512),[[y,t.productCodeEdit.VAT]]),t.errors.VAT?(s(),i("div",Te,p(t.errors.VAT[0]),1)):a("",!0)])])])):a("",!0)])])]),e("div",Ae,[t.editing?(s(),i("button",{key:0,disabled:t.saving,onClick:o[22]||(o[22]=r=>l.save()),type:"button",class:"btn btnSize02 tertiaryBtn"},p(l.saveButtonText),9,Se)):a("",!0),!t.editing&&t.productCodeId?(s(),i("button",{key:1,disabled:t.saving,onClick:o[23]||(o[23]=r=>l.addPricing()),type:"button",class:"btn btnSize02 tertiaryBtn"}," Add New Pricing ",8,Be)):a("",!0),t.editing&&t.productCodeId?(s(),i("button",{key:2,disabled:t.saving,onClick:o[24]||(o[24]=r=>l.back()),type:"button",class:"btn btnSize02 tertiaryBtn"}," Back ",8,Le)):a("",!0),e("button",{disabled:t.saving,onClick:o[25]||(o[25]=r=>l.clear()),type:"button",class:"btn btnSize02 tertiaryBtn"}," Cancel ",8,Ue)])])])):a("",!0)]),_:1})}const Ne=w(F,[["render",Ve]]),Fe={components:{AdditionalEdit:Ne,Treeselect:S},mixins:[B,N],data(){return{loading:!1,filtersVisible:!1,hiddenColumns:["AIID","CountryID","Group","Status","editing","new","Description"],labels:[],productFilter:[],labelsUnedited:[],products:[],productsList:[],productsExpanded:[],productsAdd:[],countries:[],alphabet:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],columns:{label:["Country","Description","Options"]},filter:{letter:"all",company:0,fridge:"all",productType:"all",reclassification:"all",package:"all",fdb:"0",name:{status:!1,value:""},code:{status:!1,value:""}},values:{name:"",code:""},tab:"drug"}},mounted(){this.getLabels(),this.getCountries(),this.emitter.on("product.refresh",()=>{this.getLabels()})},destroyed(){this.emitter.off("product.refresh")},computed:{visibleColumns(){return this.columns.label},searchString(){return`?product=${this.productFilter}`},visibleLabels(){return this.labels},groupedLabels(){let t=[],o=[];this.labels.forEach(d=>{typeof t[d.Group]>"u"&&(t[d.Group]={array:[],group:d.Group}),t[d.Group].array.push(d)});for(const d in t)o.push(t[d]);return o},groups(){let t=[];return this.labels.forEach(o=>{t.includes(o.Group)||t.push(o.Group)}),t},csvUrl(){return this.tab=="drug"?`/inventory/products/csv${this.searchString}`:`/inventory/countries/csv${this.searchString}`}},watch:{searchString(){this.getLabels()}},methods:{loadOptions:_.debounce(function({action:t,searchQuery:o,callback:d}){t==="ASYNC_SEARCH"&&this.getProductList(o,h=>{let u=[];h.forEach(l=>{u.push({id:l.ProductCodeID,label:l.Name})}),d(null,u)})},500),sanitizeDescription(t){return L.sanitize(t)},getLabels(){this.loading=!0,axios.get(`/additional-information${this.searchString}`).then(t=>{this.labels=t.data.data,this.labelsUnedited=JSON.parse(JSON.stringify(t.data.data)),this.push=0}).catch(t=>{this.postError(t.response.data.message)}).finally(()=>{this.loading=!1})},saveFilter(t){this.filter[t].value=this.values[t],this.toggleFilter(t)},clearFilter(t){this.filter[t].value="",this.values[t]="",this.filter[t].status=!1},toggleFilter(t){this.filter[t].status=!this.filter[t].status,this.filter[t].status&&setTimeout(()=>{let o=document.getElementById(`${t}-filter`);o.focus(),o.select()},10)},getCountries(){this.loading=!0,axios.get("/countries").then(t=>{this.countries=t.data.data}).catch(t=>{this.postError(t.response.data.message)}).finally(()=>{this.loading=!1})},getProductList(t="",o=!1){let d=t!=""?`?filter=${t}`:"";axios.get(`/products${d}`).then(h=>{o?o(h.data.data):this.productsList=h.data.data}).catch(h=>{console.log(h),this.postError(h.response.data.message)})},editLabel(t){t.editing=!0},addLabel(t){let o={CountryID:1,Description:"",Group:t,Status:1,editing:!0,new:!0,AIID:Date.now()};this.labels.unshift(o)},updateLabel(t){axios.patch(`/additional-information/${t.AIID}`,t).then(o=>{this.postSuccess("Changes saved"),this.getLabels()}).catch(o=>{this.postError(o.response.data.message)}).finally(()=>{t.editing=!1})},cancelEdit(t){let o=this.labelsUnedited.find(d=>d.AIID===t.AIID);t.Description=o.Description,t.editing=!1},saveLabel(t){axios.post("/additional-information",t).then(o=>{this.labels.splice(this.labels.findIndex(d=>d.AIID===t.AIID),1),this.labels.unshift(o.data.data),this.postSuccess(o.data.message)}).catch(o=>{this.postError(o.response.data.message)})},deleteLabel(t){this.$swal({title:"Delete Label",html:"Are you sure you want to delete this label?",type:"warning",showCancelButton:!0,confirmButtonColor:"#ff5151",cancelButtonColor:"#d33",confirmButtonText:"Yes!"}).then(o=>{o.value&&axios.delete(`/additional-information/${t.AIID}`).then(d=>{this.labels.splice(this.labels.findIndex(h=>h.AIID===t.AIID),1),this.postSuccess(d.data.message)}).catch(d=>{this.postError(d.response.data.message)})})},removeProduct(t,o){this.$swal({title:"Remove product",html:"Are you sure you want to remove product from this group?",type:"warning",showCancelButton:!0,confirmButtonColor:"#ff5151",cancelButtonColor:"#d33",confirmButtonText:"Yes!"}).then(d=>{d.value&&axios.delete(`/additional-information/group/${o}/products/${t}`).then(h=>{this.getProducts(o),this.postSuccess(h.data.message)}).catch(h=>{this.postError(h.response.data.message)})})},addProduct(t,o){axios.put(`/additional-information/group/${o}/products/${t}`).then(d=>{this.getProducts(o),this.logSystemActivity(t,6,903,{group:o,productCodeId:t}),this.postSuccess(d.data.message)}).catch(d=>{this.postError(d.response.data.message)})},addGroup(){this.labels.unshift({Group:0,editing:!0,new:!0,CountryID:1,Country:"",Description:"",Status:1,Name:""})},showProducts(t){this.productsExpanded.includes(t)?(this.productsExpanded.splice(this.productsExpanded.indexOf(t),1),this.products.splice(t,1)):this.getProducts(t,()=>{this.productsExpanded.push(t)})},getProducts(t,o=!1){axios.get(`/additional-information/group/${t}/products`).then(d=>{this.products.splice(t,1),this.products[t]=d.data.data,o&&o()}).catch(d=>{this.postError(d.response.data.message)})},cancelLabel(t){this.labels.splice(this.labels.findIndex(o=>o.AIID===t.AIID),1)},openEditModal(t){this.emitter.emit("label.add")},check(t,o){o==1?axios.post(`/additional-information/${t}/disable`).then(d=>{this.postWarning("Label disabled")}).catch(d=>{console.log(d)}).finally(()=>{this.getLabels()}):axios.post(`/additional-information/${t}/enable`).then(d=>{this.postSuccess("Label enabled")}).catch(d=>{console.log(d)}).finally(()=>{this.getLabels()})},checkProduct(t,o,d){d==1?axios.post(`/additional-information/${o}/disable/product`,{code:t}).then(h=>{this.postWarning("Label disabled")}).catch(h=>{console.log(h)}).finally(()=>{this.getProducts(o)}):axios.post(`/additional-information/${o}/enable/product`,{code:t}).then(h=>{this.postSuccess("Label enabled")}).catch(h=>{console.log(h)}).finally(()=>{this.getProducts(o)})}}},Oe={class:"products natcol-table content"},xe={class:"card"},Ge=e("div",{class:"card-header"},[e("h3",null,"Additional Information")],-1),Me={class:"products-header mb-10"},ze={class:"products-navigation"},Qe={class:"products-buttons",style:{display:"flex","align-items":"center","justify-content":"center"}},He=e("i",{class:"fa fa-plus"},null,-1),Ye={class:"card-body"},Je={id:"warning-label-table",class:"products-body"},je={class:"table table-hover"},Re={class:"primary-color text-white"},We={style:{background:"rgb(60 165 168)",border:"solid 1px rgb(60 165 168)",color:"#fff","font-size":"18px","padding-left":"15px!important"},colspan:"2"},Ke={key:0},Xe={key:1},Ze={style:{background:"rgb(60 165 168)",border:"solid 1px rgb(60 165 168)",color:"#fff","max-width":"300px"},colspan:"1"},qe=["onClick"],to=e("i",{class:"fa fa-plus"},null,-1),eo=[to],oo=["onClick"],so={key:0},io={colspan:"3"},ro={key:0},no={colspan:"4",style:{background:"white","border-bottom":"1px solid gainsboro"}},lo={style:{display:"flex","justify-content":"flex-start","align-items":"center"}},ao=["onClick"],co=e("tr",null,[e("th",null,"Code"),e("th",null,"Name"),e("th",null,"Tools")],-1),uo=["onClick"],po=e("i",{class:"fa fa-trash"},null,-1),ho=[po],fo={key:1},mo={style:{"padding-bottom":"10px","padding-top":"10px"}},go={style:{display:"flex","justify-content":"flex-start","align-items":"center"}},bo=["onClick"],yo=e("li",null,"No products found in this group",-1),Co={key:0,style:{"padding-left":"15px!important","max-width":"120px!important"}},_o=["onUpdate:modelValue"],vo=["value"],ko={key:1,style:{"padding-left":"15px!important","max-width":"120px!important"}},Io=["innerHTML"],Po=["innerHTML"],wo=["onUpdate:modelValue"],Do={key:0},$o=["onClick"],Eo=e("i",{class:"fa fa-edit"},null,-1),To=[Eo],Ao=["onClick"],So=e("i",{class:"fa fa-trash"},null,-1),Bo=[So],Lo=["onClick"],Uo=e("i",{class:"fa fa-save"},null,-1),Vo=[Uo],No=["onClick"],Fo=e("i",{class:"fa fa-undo"},null,-1),Oo=[Fo],xo={key:1},Go=["onClick"],Mo=e("i",{class:"fa fa-save"},null,-1),zo=[Mo],Qo=["onClick"],Ho=e("i",{class:"fa fa-minus"},null,-1),Yo=[Ho],Jo={key:1},jo=["colspan"],Ro=e("div",{class:"no-results-found"}," No matching search results found! ",-1),Wo=[Ro],Ko=e("div",{class:"products-footer card-footer"},null,-1);function Xo(t,o,d,h,u,l){const r=P("treeselect"),v=P("AdditionalEdit");return s(),i("section",Oe,[e("section",xe,[Ge,e("div",Me,[e("div",ze,[e("div",Qe,[e("button",{title:"Add New Cautionary and Advisory Label",class:"btn btnSize02 secondaryBtn mt-10 ml-10",onClick:o[0]||(o[0]=c=>l.addGroup())},[He,U(" Add New Group ")]),k(r,{class:"mt-10 ml-10",async:!0,searchable:!0,multiple:!0,"close-on-select":!1,"open-on-click":!0,"open-on-focus":!0,"clear-on-select":!0,"disable-branch-nodes":!0,placeholder:"Select Product","show-count":!0,"default-expand-level":1,"default-options":u.productsList,"load-options":l.loadOptions,"append-to-body":!1,modelValue:u.productFilter,"onUpdate:modelValue":o[1]||(o[1]=c=>u.productFilter=c),disabled:u.loading},null,8,["default-options","load-options","modelValue","disabled"])])])]),e("div",Ye,[e("div",Je,[e("table",je,[e("thead",Re,[e("tr",null,[(s(!0),i(g,null,b(l.visibleColumns,(c,I)=>(s(),i("th",{key:I},[e("span",null,p(c),1)]))),128))])]),u.labels.length>0?(s(!0),i(g,{key:0},b(l.groupedLabels,(c,I)=>(s(),i("tbody",{key:I},[e("tr",null,[e("td",We,[c.group==0?(s(),i("span",Ke,"New Group")):(s(),i("span",Xe,"Group "+p(c.group),1))]),e("td",Ze,[e("button",{title:"Add Label",onClick:n=>l.addLabel(c.group),class:"btn btn-primary waves-effect table-icon"},eo,8,qe),e("button",{title:"Show products",onClick:n=>l.showProducts(c.group),class:"btn btn-primary waves-effect table-icon"},[e("i",{class:V(["fa",[u.productsExpanded.includes(c.group)?"fa-caret-up":"fa-caret-down"]])},null,2)],8,oo)])]),u.productsExpanded.includes(c.group)?(s(),i("tr",so,[e("td",io,[u.products[c.group]&&u.products[c.group].length>0?(s(),i("table",ro,[e("thead",null,[e("tr",null,[e("th",no,[e("div",lo,[k(r,{modelValue:u.productsAdd[c.group],"onUpdate:modelValue":n=>u.productsAdd[c.group]=n,"disable-branch-nodes":!0,placeholder:"Select Product","show-count":!0,"default-expand-level":1,"load-options":l.loadOptions,async:!0,"append-to-body":!1,disabled:u.loading},null,8,["modelValue","onUpdate:modelValue","load-options","disabled"]),u.productsAdd[c.group]?(s(),i("button",{key:0,class:"btn btnSize02 tertiaryBtn ml-10",onClick:n=>l.addProduct(u.productsAdd[c.group],c.group)},"Add",8,ao)):a("",!0)])])]),co]),e("tbody",null,[(s(!0),i(g,null,b(u.products[c.group],n=>(s(),i("tr",{key:n.Code},[e("td",null,p(n.Code),1),e("td",null,p(n.Name)+" ("+p(n.Quantity)+" "+p(n.Units)+") ",1),e("td",null,[e("button",{title:"Remove product from group",onClick:m=>l.removeProduct(n.ProductCodeID,c.group),class:"btn btn-primary table-icon table-icon-danger"},ho,8,uo)])]))),128))])])):(s(),i("div",fo,[e("ul",null,[e("li",mo,[e("div",go,[k(r,{modelValue:u.productsAdd[c.group],"onUpdate:modelValue":n=>u.productsAdd[c.group]=n,"disable-branch-nodes":!0,placeholder:"Select Product","show-count":!0,"default-expand-level":1,"load-options":l.loadOptions,async:!0,"append-to-body":!1,disabled:u.loading},null,8,["modelValue","onUpdate:modelValue","load-options","disabled"]),u.productsAdd[c.group]?(s(),i("button",{key:0,class:"btn btnSize02 tertiaryBtn ml-10",onClick:n=>l.addProduct(u.productsAdd[c.group],c.group)},"Add",8,bo)):a("",!0)])]),yo])]))])])):a("",!0),(s(!0),i(g,null,b(c.array,n=>(s(),i("tr",{key:n.ProductCodeID},[n.editing?(s(),i("td",Co,[f(e("select",{name:"country","onUpdate:modelValue":m=>n.CountryID=m,style:{padding:"5px"}},[(s(!0),i(g,null,b(u.countries,m=>(s(),i("option",{value:m.CountryID,key:m.CountryID},p(m.Name),9,vo))),128))],8,_o),[[y,n.CountryID]])])):(s(),i("td",ko,[e("span",{innerHTML:n.Country},null,8,Io)])),e("td",null,[n.editing?f((s(),i("textarea",{key:1,type:"text","onUpdate:modelValue":m=>n.Description=m,style:{width:"100%",padding:"5px"}},`
                                        `,8,wo)),[[C,n.Description]]):(s(),i("div",{key:0,style:{padding:"10px"},innerHTML:l.sanitizeDescription(n.Description)},null,8,Po))]),e("td",null,[n.new?(s(),i("div",xo,[n.editing?(s(),i("button",{key:0,title:"Save label",onClick:m=>l.saveLabel(n),class:"btn btn-primary waves-effect table-icon"},zo,8,Go)):a("",!0),n.editing?(s(),i("button",{key:1,title:"Cancel creating this label",onClick:m=>l.cancelLabel(n),class:"btn btn-primary table-icon table-icon-danger"},Yo,8,Qo)):a("",!0)])):(s(),i("div",Do,[n.editing?a("",!0):(s(),i("button",{key:0,title:"Edit this label",onClick:m=>l.editLabel(n),class:"btn btn-primary waves-effect table-icon"},To,8,$o)),n.editing?a("",!0):(s(),i("button",{key:1,title:"Delete this label",onClick:m=>l.deleteLabel(n),class:"btn btn-primary table-icon table-icon-danger"},Bo,8,Ao)),n.editing?(s(),i("button",{key:2,title:"Save changes to this label",onClick:m=>l.updateLabel(n),class:"btn btn-primary waves-effect table-icon"},Vo,8,Lo)):a("",!0),n.editing?(s(),i("button",{key:3,title:"Undo changes to this label",onClick:m=>l.cancelEdit(n),class:"btn btn-primary table-icon table-icon-danger"},Oo,8,No)):a("",!0)]))])]))),128))]))),128)):(s(),i("tbody",Jo,[e("tr",null,[e("td",{colspan:l.visibleColumns.length},Wo,8,jo)])]))])])]),Ko]),k(v)])}const ts=w(Fe,[["render",Xo]]);export{ts as default};
//# sourceMappingURL=Additional-DHykdTiR.js.map
