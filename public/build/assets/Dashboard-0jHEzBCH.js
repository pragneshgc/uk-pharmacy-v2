const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Modal-C4m4T6Vr.js","assets/app-Day-6uLD.js","assets/app-DWMI0VDG.css"])))=>i.map(i=>d[i]);
import{_ as g,a as y,E as k,c as l,b as e,F as p,r as m,d as a,n as h,e as c,t as n,f as _,g as v,w as b,h as C,o as i,i as P}from"./app-Day-6uLD.js";import{C as O}from"./csv-D9clh__g.js";const I={components:{Modal:()=>y(()=>import("./Modal-C4m4T6Vr.js"),__vite__mapDeps([0,1,2]))},mixins:[k,O],data:function(){return{statistics:{},pendingPrescriberCount:0,pendingPharmacyOrdersCount:0,pendingPharmacyOrders:[],onHoldOrders:[],pendingOrderAlerts:[],loadingPendingPharmacy:!1,loaded:!1,orderFilter:this.$route.query.orderFilter||localStorage.getItem("dashboard.orderFilter")?localStorage.getItem("dashboard.orderFilter"):userInfo.role==20||userInfo.role==19?"approved":"new",checkboxStatus:!1,duplicateReference:0,userInfo,mapping:{safety:"safety check",new:"new",approved:"approved",dpd:"dpd",ups:"ups",dhl:"dhl",rml:"rml",awaiting:"awaiting shipped",shipped:"shipped",onhold:"onhold",queried:"queried",rejected:"rejected",cancelled:"cancelled",return:"returned"},roleVisibility:{60:[],50:[],40:[],35:[],30:[],29:[],25:[],20:[],19:[],10:[],5:[]},countTimer:null}},computed:{checked(){return this.$store.state.checked},visible(){return this.$store.state.visible},match(){return this.checked.length==0?!1:this.visible.every(t=>this.checked.indexOf(t)>=0)},currentChecked(){return this.checked.length==0?!1:this.checked.some(t=>this.visible.indexOf(t)>=0)},trayLength(){return this.$store.state.tray.length}},mounted(){this.getStatistics(),this.getCount(),this.getOrderAlerts(),this.getOnHoldOrders(),this.emitter.on("changefilter",t=>{this.orderFilter=t.filter}),this.emitter.on("orderupdate",this.getOrderAlerts)},destroyed(){this.emitter.off("changefilter"),this.emitter.off("orderupdate"),clearInterval(this.countTimer)},methods:{getStatistics(){axios.get("/statistics").then(t=>{this.statistics=t.data.data,this.statistics.total=t.data.data.total,this.loaded=!0}).catch(t=>{this.postError(t.response.data.message)})},getCount(t=!1){this.loadingPendingPharmacy=!0,t?(this.getOrderAlerts(),this.checkOrders(()=>{this.getCount(),this.getOnHoldOrders(),this.emitter.emit("alertupdate")})):axios.get("/api/check-orders/results").then(s=>{this.pendingPrescriberCount=s.data.data.pendingPrescriberCount,this.pendingPharmacyOrders=s.data.data.pendingPharmacyOrders,this.pendingPharmacyOrdersCount=s.data.data.pendingPharmacyOrdersCount}).catch(s=>{this.postError(s.response.data.message)}).finally(()=>{this.loadingPendingPharmacy=!1,this.emitter.emit("alertupdate")})},getOrderAlerts(){axios.get("/note/pending-alerts").then(t=>{this.pendingOrderAlerts=t.data.data}).catch(t=>{this.postError(t.response.data.message)})},getOnHoldOrders(){axios.get("/orders/on-hold-postponed").then(t=>{this.onHoldOrders=t.data.data}).catch(t=>{this.postError(t.response.data.message)})},deleteNote(t){this.$swal({title:"Delete Alert",html:"Are you sure you want to delete this alert?",type:"warning",showCancelButton:!0,confirmButtonColor:"#ff5151",cancelButtonColor:"#d33",confirmButtonText:"Yes!"}).then(s=>{s.value&&axios.post("/note/"+t+"/delete").then(d=>{this.postSuccess(d.data.message)}).catch(d=>{this.postError(d.response.data.message)}).finally(()=>{this.getOrderAlerts(),this.emitter.emit("alertupdate")})})},editNote(t=!1){this.emitter.emit("modal.open","note",t)},getPendingCSV(){let t=[];this.pendingPharmacyOrders.forEach(s=>{t.push({ReferenceNumber:s.Value})}),this.exportCSV(t,`Pending Pharmacy Orders ${new Date().toLocaleString()}`)},checkOrders(t=!1){axios.get("/api/check-orders").then(s=>{t&&t()}).catch(s=>{this.postError(s.response.data.data),this.loadingPendingPharmacy=!1})},redirectCallback(){this.orderFilter=="new"&&this.trayLength<1&&(this.userInfo.role==30||this.userInfo.role==35||this.userInfo.role==29)&&axios.post("/tray/new/insert/20").then(t=>{this.postSuccess(t.data.message),this.emitter.emit("tray.refresh")}).catch(t=>{this.postError(t.response.data.message)})},changeOrder(t){t=="queried"?localStorage.setItem("dashboard.orderFilter",t):localStorage.setItem("dashboard.orderFilter",this.userInfo.role==20||this.userInfo.role==19?"approved":"new"),this.orderFilter=t,this.getStatistics(),this.getCount()},addToTray(){axios.post("/tray",{PrescriptionID:this.checked}).then(t=>{this.postSuccess(t.data.message),this.$store.commit("replaceChecked",[]),this.emitter.emit("tray.refresh"),this.emitter.emit("table.refresh")}).catch(t=>{this.postError(t.response.data.message)})},safe(t){axios.post(`/order-edit/${t}/status`,{status:1}).then(s=>{this.emitter.emit("table.refresh")}).catch(s=>{this.emitter.emit("table.refresh"),this.postError(s.response.data.message)}).finally(()=>{this.getStatistics()})},checkAll(t=!1){axios.get(`/orders/ids?f=${this.orderFilter}&intray=false&limit=${t}`).then(s=>{this.$store.commit("replaceChecked",s.data.data)}).catch(s=>{this.postError(s.response.data.message)})},checkByProperty(t,s){axios.get(`/orders/ids?f=${this.orderFilter}&intray=false&type=${t}&property=${s}`).then(d=>{this.$store.commit("replaceChecked",d.data.data)}).catch(d=>{this.postError(d.response.data.message)})},checkAllVisible(){this.currentChecked&&!this.match?this.emitter.emit("table.uncheck.all"):this.currentChecked&&this.match?this.emitter.emit("table.uncheck.all"):this.emitter.emit("table.check.all")},clearChecked(){this.checkboxStatus=!1,this.$store.commit("replaceChecked",[])},viewOrder(t){this.$router.push({name:"prescription",params:{id:t}})}}},S={class:"content"},w={class:"prescriptionStats flex-center"},A=e("div",{class:"title flex-align-center"},"Order Statistics",-1),D={class:"list"},N={key:0},E=["onClick"],F=e("span",null,"Alert",-1),R={key:1,style:{overflow:"hidden"}},T=e("li",null,[e("div",{class:"loader loader-relative",style:{}},"Loading...")],-1),B=[T],$={key:0,class:"total flex-align-center clickable"},V=e("span",null,"Total",-1),H=e("a",{href:'/orders/csv?page=1&limit=1000&f={"dashboard": true}&strict=true',class:"btn smallTextBtn secondaryBtn",title:"Download dashboard orders"},"Download",-1),L={class:"orderSearch"},M={class:"row check-row"},j={class:"button-group"},G=["checked"],q=e("label",{for:"checkall"},null,-1),z={class:"btn btnSize02 secondaryBtn dropdown"},Y=e("i",{"aria-hidden":"true",class:"fa fa-caret-down"},null,-1),U={class:"dropdown-menu"},J=e("li",null,[e("hr")],-1),K=e("li",null,[e("hr")],-1),Q=e("li",null,[e("hr")],-1),W={key:0,class:"check-options"},X={key:0},Z={key:1},x=["onClick"],ee={key:1,class:"card prescription-pool"},te={class:"card-body order-id-list"},se={class:"pool-list-title pb-10",style:{display:"flex","justify-content":"space-between","align-items":"center"}},re=e("i",{"aria-hidden":"true",class:"fa fa-file"},null,-1),oe=[re],ie={key:0,class:"pool-list-layout"},le=e("div",{class:"pool-column"},[e("b",null,"Reference Number")],-1),ne=e("div",{class:"pool-column"},[e("b",null,"Client")],-1),ae=e("div",{class:"pool-column"},[e("b",null,"Status")],-1),de=[le,ne,ae],ce={class:"pool-column"},he={class:"pool-column"},ue=e("div",{class:"pool-column"},[e("b",null,"Pending")],-1),pe={key:0},me=e("li",{class:"pool-list-title"},[e("b",null,"NO PENDING PHARMACY ORDERS FOUND")],-1),be=[me],fe={class:"mt-10"},ge={class:"pool-list-title pb-10",style:{display:"flex","justify-content":"space-between","align-items":"center"}},ye={key:0,class:"pool-list-layout"},ke=P('<div class="pool-column"><b>ID</b></div><div class="pool-column"><b>Reference Number</b></div><div class="pool-column"><b>Postponed At</b></div><div class="pool-column"><b>Postponed By</b></div><div class="pool-column">Tools</div>',5),_e=[ke],ve={class:"pool-column"},Ce={class:"pool-column"},Pe=["innerHTML"],Oe={class:"pool-column"},Ie={class:"pool-column"},Se={class:"pool-column"},we=["href"],Ae=e("i",{"aria-hidden":"true",class:"fa fa-search-plus"},null,-1),De=[Ae],Ne={class:"mt-10"},Ee={class:"pool-list-title pb-10",style:{display:"flex","justify-content":"space-between","align-items":"center"}},Fe={key:0,class:"pool-list-layout"},Re=e("div",{class:"pool-column"},[e("b",null,"Reference Number")],-1),Te=e("div",{class:"pool-column"},[e("b",null,"Note")],-1),Be=e("div",{class:"pool-column"},[e("b",null,"Created By")],-1),$e=e("div",{class:"pool-column"},[e("b",null,"Created At")],-1),Ve={key:0,class:"pool-column"},He={class:"pool-column"},Le={key:0},Me=e("br",null,null,-1),je=e("small",null,"Reference number not set",-1),Ge={key:1},qe={class:"pool-column"},ze=["innerHTML"],Ye={class:"pool-column"},Ue={class:"pool-column"},Je={key:0,class:"pool-column"},Ke=["onClick"],Qe=e("i",{"aria-hidden":"true",class:"fa fa-edit"},null,-1),We=[Qe],Xe=["onClick"],Ze=e("i",{"aria-hidden":"true",class:"fa fa-trash"},null,-1),xe=[Ze];function et(t,s,d,tt,st,o){const f=C("data-table");return i(),l("div",null,[e("div",S,[e("section",null,[e("div",w,[A,e("div",D,[t.loaded?(i(),l("ul",N,[t.roleVisibility[t.userInfo.role].includes(t.key)?a("",!0):(i(!0),l(p,{key:0},m(t.statistics.statistics,(r,u)=>(i(),l("li",{class:h(["list-item-background",{active:u==t.orderFilter}]),onClick:rt=>o.changeOrder(u)},[e("span",null,n(t.mapping[u]),1),c(n(r),1)],10,E))),256)),t.roleVisibility[t.userInfo.role].includes("ordercount")?a("",!0):(i(),l("li",{key:1,class:h([[t.orderFilter=="ordercount"?"active":"",t.pendingPharmacyOrdersCount>0?"blink_me":""],"list-item-background"]),onClick:s[0]||(s[0]=r=>{t.orderFilter="ordercount"})},[F,c(n(t.pendingPharmacyOrdersCount),1)],2))])):(i(),l("ul",R,B))]),t.loaded?(i(),l("div",$,[V,c(" "+n(t.statistics.total)+" ",1),H])):a("",!0)])]),e("section",null,[e("div",L,[t.orderFilter!="ordercount"?(i(),_(f,{key:0,"data-url":"/orders","column-class":"col-lg-12","table-title":"InTray","redirect-name":"prescription","redirect-id":"PrescriptionID",filters:t.orderFilter,"redirect-callback":o.redirectCallback,"checkbox-visible":t.orderFilter=="new"&&[29,30,35].includes(t.userInfo.role),"hidden-columns":["checked","disabled","UPSAccessPointAddress"],"not-orderable":["Products"],"column-map":{PrescriptionID:"ID",DeliveryID:"Courier",CompanyName:"Client",ReferenceNumber:"Ref"}},v({_:2},[t.orderFilter=="new"&&[29,30,35].includes(t.userInfo.role)?{name:"filters",fn:b(()=>[e("div",M,[e("div",j,[e("div",{class:"btn btnSize02 secondaryBtn",onClick:s[1]||(s[1]=r=>o.checkAllVisible())},[e("input",{class:h({unchecked:!o.match&&o.currentChecked}),checked:o.match||o.currentChecked,type:"checkbox",name:"checkall"},null,10,G),q]),e("div",z,[Y,e("ul",U,[e("li",{onClick:s[2]||(s[2]=r=>o.checkAll()),class:"dropdown-menu-item"}," Check All In "+n(t.orderFilter),1),e("li",{onClick:s[3]||(s[3]=r=>o.checkAll(10)),class:"dropdown-menu-item"}," Check 10 "),e("li",{onClick:s[4]||(s[4]=r=>o.checkAll(20)),class:"dropdown-menu-item"}," Check 20 "),e("li",{onClick:s[5]||(s[5]=r=>o.checkAll(50)),class:"dropdown-menu-item"}," Check 50 "),e("li",{onClick:s[6]||(s[6]=r=>o.checkAll(100)),class:"dropdown-menu-item"}," Check 100 "),J,e("li",{onClick:s[7]||(s[7]=r=>o.checkByProperty("delivery",4)),class:"dropdown-menu-item"}," Check DPD "),e("li",{onClick:s[8]||(s[8]=r=>o.checkByProperty("delivery",5)),class:"dropdown-menu-item"}," Check RM "),K,e("li",{onClick:s[9]||(s[9]=r=>o.checkByProperty("client",50)),class:"dropdown-menu-item"}," Check Treated "),e("li",{onClick:s[10]||(s[10]=r=>o.checkByProperty("client",51)),class:"dropdown-menu-item"}," Check EveAdam "),e("li",{onClick:s[11]||(s[11]=r=>o.checkByProperty("client",49)),class:"dropdown-menu-item"}," Check Apport Sarl "),Q,e("li",{onClick:s[12]||(s[12]=r=>o.clearChecked()),class:"dropdown-menu-item"}," Clear checked ")])])]),o.checked.length>0?(i(),l("div",W,[e("button",{onClick:s[13]||(s[13]=r=>o.addToTray()),class:"btn btnSize02 secondaryBtn"},[t.userInfo.role==20||t.userInfo.role==19?(i(),l("span",X,"Take over")):(i(),l("span",Z,"Add To Tray")),c(" ("+n(o.checked.length)+" orders) ",1)])])):a("",!0)])]),key:"0"}:void 0,t.orderFilter=="safety"&&t.userInfo.role==40?{name:"tools",fn:b(r=>[e("a",{class:"btn btn-primary waves-effect table-icon clickable",onClick:u=>o.safe(r.id)}," Safe ",8,x)]),key:"1"}:void 0]),1032,["filters","redirect-callback","checkbox-visible"])):t.orderFilter=="ordercount"?(i(),l("div",ee,[e("div",te,[e("ul",null,[e("li",se,[e("b",null,[c("MISSING PHARMACY ORDERS "),e("span",{class:h(["badge",[t.pendingPharmacyOrders.length>0?"red":""]])},n(t.pendingPharmacyOrders.length),3)]),e("div",null,[e("button",{class:"btn btn-primary table-icon",title:"Download CSV with a list of reference numbers",onClick:s[14]||(s[14]=r=>o.getPendingCSV())},oe),e("button",{class:"btn btn-primary table-icon",title:"Refresh the pending pharmacy orders list manually",onClick:s[15]||(s[15]=r=>o.getCount(!0))},[e("i",{class:h(["fa fa-refresh",[t.loadingPendingPharmacy?"spin-animation":""]])},null,2)])])]),t.pendingPharmacyOrders.length>0?(i(),l("li",ie,de)):a("",!0),(i(!0),l(p,null,m(t.pendingPharmacyOrders,r=>(i(),l("li",{class:"pool-list-layout",key:r.SyncOrderID},[e("div",ce,n(r.Value),1),e("div",he,[e("span",null,n(r.CompanyName),1)]),ue]))),128))]),t.pendingPharmacyOrdersCount+t.pendingPrescriberCount==0?(i(),l("ul",pe,be)):a("",!0),e("ul",fe,[e("li",ge,[e("b",null,[c("POSTPONED SHIPPING ORDERS PENDING "),e("span",{class:h(["badge",[t.onHoldOrders.length>0?"red":""]])},n(t.onHoldOrders.length),3)])]),t.onHoldOrders.length>0?(i(),l("li",ye,_e)):a("",!0),(i(!0),l(p,null,m(t.onHoldOrders,r=>(i(),l("li",{class:"pool-list-layout",key:r.PrescriptionID},[e("div",ve,[e("b",null,n(r.PrescriptionID),1)]),e("div",Ce,[e("div",{innerHTML:r.ReferenceNumber},null,8,Pe)]),e("div",Oe,n(r.PostponedAt),1),e("div",Ie,n(r.PostponedBy),1),e("div",Se,[e("a",{title:"View Order",class:"btn btn-primary table-icon",target:"_blank",href:`#/prescription/${r.PrescriptionID}`},De,8,we)])]))),128))]),e("ul",Ne,[e("li",Ee,[e("b",null,[c("PENDING ORDER ALERTS "),e("span",{class:h(["badge",[t.pendingOrderAlerts.length>0?"red":""]])},n(t.pendingOrderAlerts.length),3)]),e("div",null,[e("button",{title:"Create an alert for a prescription that is not yet imported on ESA",onClick:s[16]||(s[16]=r=>{t.$root.$emit("modal.open","note","preimport")}),class:"btn btn-primary table-icon"}," Create Alert ")])]),t.pendingOrderAlerts.length>0?(i(),l("li",Fe,[Re,Te,Be,$e,t.userInfo.role>=40?(i(),l("div",Ve,"Tools")):a("",!0)])):a("",!0),(i(!0),l(p,null,m(t.pendingOrderAlerts,r=>(i(),l("li",{class:"pool-list-layout",key:r.NoteID},[e("div",He,[r.Subscription?(i(),l("div",Le,[e("small",null,[c("Subscription ID: "),e("b",null,n(r.Subscription),1)]),Me,je])):(i(),l("b",Ge,n(r.ReferenceNumber),1))]),e("div",qe,[e("div",{innerHTML:r.Note},null,8,ze)]),e("div",Ye,n(r.name)+" "+n(r.surname),1),e("div",Ue,n(r.CreatedAt),1),t.userInfo.role>=40?(i(),l("div",Je,[e("button",{title:"Edit alert",class:"btn btn-primary table-icon",onClick:u=>o.editNote(r)},We,8,Ke),e("button",{title:"Delete this alert",class:"btn btn-primary table-icon",onClick:u=>o.deleteNote(r.NoteID)},xe,8,Xe)])):a("",!0)]))),128))])])])):a("",!0)])])])])}const lt=g(I,[["render",et]]);export{lt as default};
//# sourceMappingURL=Dashboard-0jHEzBCH.js.map
