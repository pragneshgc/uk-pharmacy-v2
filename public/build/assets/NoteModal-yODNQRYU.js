import b from"./Modal-CwO9xAd8.js";import{_ as y,E as v,e as N,o as s,h as T,j as k,c as n,b as a,a as o,w as h,F as w,f as S,A as E,n as B,g as f,B as c,m as D,t as I,T as C}from"./app-CzB2aCin.js";import{_ as A}from"./Editor-CvssQfDm.js";const R={mixins:[v],props:["orderID"],extends:b,components:{Editor:A},data:function(){return{form:{options:[{name:'Patient Note <span style="font-style: italic;">(Patient specific notes)</span>',value:1},{name:"Query Note",value:2},{name:'Order Note <span style="font-size: 13px;">(Order specific notes)</span>',value:3}],Type:0,Note:"",Alert:!1,ReferenceNumber:!1,Subscription:!1},userInfo,error:"",editing:!1,preimport:!1,backdrop:!0,dragEventTriggered:!1}},computed:{options(){return this.preimport?[{name:"Subscription Note",value:4},{name:"Order Note",value:3}]:this.userInfo.role==30?this.form.options:[{name:'Order Note <span style="font-size: 13px;">(Order specific notes)</span>',value:3},{name:'Patient Note <span style="font-size: 13px;">(Patient specific notes)</span>',value:1}]}},mounted(){this.emitter.on("modal.open",(t,e)=>{t==this.modalName&&(this.show.modal=!0),e&&e!="preimport"&&e.Type!=3&&e.Type!=4?(this.editing=e,this.form.Type=e.Type,this.form.Note=e.Note,this.form.Alert=e.Alert!=0,console.log("the note is this")):e&&(e.Type==3||e.Type==4)?(this.editing=e,this.form.Type=e.Type,this.form.Note=e.Note,this.form.Alert=!0,this.preimport=!0,this.form.ReferenceNumber=e.ReferenceNumber):e=="preimport"&&(this.form.Type=4,this.form.Note="",this.form.Alert=!0,this.form.ReferenceNumber="",this.form.Subscription="",this.preimport=!0)}),this.emitter.on("modal.close",t=>{t==this.modalName&&this.close()}),this.emitter.on("modal.close.all",()=>{this.close()})},watch:{"form.ReferenceNumber":_.debounce(function(){this.form.ReferenceNumber&&axios.get(`/order/${this.form.ReferenceNumber}/exists`).then(t=>{t.data.data?this.error="This Reference Number is already in the system!":this.error=""}).catch(t=>{this.error=""})},500),"show.modal":function(){setTimeout(()=>{this.show.modal&&!this.dragEventTriggered&&document.getElementById("draggable-div-note")?(function(e){var u=0,p=0,m=0,l=0;document.getElementById("draggable-div-header-note")?document.getElementById("draggable-div-header-note").onmousedown=d:e.onmousedown=d;function d(i){i=i||window.event,i.preventDefault(),m=i.clientX,l=i.clientY,document.onmouseup=g,document.onmousemove=r}function r(i){i=i||window.event,i.preventDefault(),u=m-i.clientX,p=l-i.clientY,m=i.clientX,l=i.clientY,e.style.top=e.offsetTop-p+"px",e.style.left=e.offsetLeft-u+"px"}function g(){document.onmouseup=null,document.onmousemove=null}}(document.getElementById("draggable-div-note")),this.dragEventTriggered=!0):(this.dragEventTriggered=!1,this.backdrop=!0)},300)}},methods:{reset(){this.form.Type=0,this.form.Note="",this.form.PrescriptionID=0,this.form.NoteID=0,this.form.Alert=!1,this.form.ReferenceNumber="",this.form.Subscription="",this.error="",this.preimport=!1,this.editing=!1},close(){this.reset(),this.show.modal=!1},toggleBackdrop(){this.backdrop=!this.backdrop},submit(){if(this.form.Type==0||this.form.Note==""){this.error="Please fill all of the required fields";return}else this.error="";this.form.Type==3&&(this.form.OrderSpecific=!0),this.preimport?this.form.PrescriptionID=null:this.form.PrescriptionID=this.orderID,axios.post("/note",this.form).then(t=>{this.postSuccess(t.data.message),this.emitter.emit("orderupdate"),this.emitter.emit("alertupdate"),this.reset()}).catch(t=>{this.postError(t.response.data.message)}).finally(()=>{this.show.modal=!1})},update(t){if(this.form.Type==0||this.form.Note==""){this.error="Please fill all of the required fields";return}else this.error="";this.form.Type==3&&(this.form.OrderSpecific=!0),this.form.NoteID=this.editing.NoteID,axios.patch(`/note/${this.form.NoteID}`,this.form).then(e=>{this.postSuccess(e.data.message),this.emitter.emit("orderupdate"),this.emitter.emit("alertupdate"),this.reset()}).catch(e=>{this.postError(e.response.data.message)}).finally(()=>{this.show.modal=!1})}}},P={key:0,class:"esa-modal"},V={class:"modal",id:"draggable-div-note"},z=o("div",{class:"modal-header draggable-div-header",id:"draggable-div-header-note"},[o("h3",null,"Create Note")],-1),M={class:"modal-body"},O=o("label",{for:"note-select"},[f("Note type "),o("small",{class:"danger"},"(required)")],-1),$=o("option",{value:"0",disabled:""},"Please select a type",-1),q=["value","innerHTML"],U=["checked"],L=o("b",null,"Alert other users",-1),X=[L],Y={key:2,for:"reference-number"},F=o("small",{class:"danger"},"(required)",-1),H={key:3,for:"reference-number"},j=o("small",{class:"danger"},"(required)",-1),Q=o("label",{for:"message-text"},[f("Note"),o("small",{class:"danger"},"(required)")],-1),G={key:6,class:"infoBox warning note-error"},J={class:"modal-footer"},K=o("i",{class:"fa fa-clone"},null,-1),W=[K],Z=o("i",{class:"fa fa-close"},null,-1),x=[Z];function ee(t,e,u,p,m,l){const d=N("Editor");return s(),T(C,{name:"fade"},{default:k(()=>[t.show.modal?(s(),n("div",P,[t.backdrop?(s(),n("div",{key:0,class:"backdrop",onClick:e[0]||(e[0]=r=>l.close())})):a("",!0),o("div",V,[z,o("div",M,[o("form",{onSubmit:e[6]||(e[6]=r=>l.submit())},[O,h(o("select",{"onUpdate:modelValue":e[1]||(e[1]=r=>t.form.Type=r),name:"note-select",class:"table-dropdown mb-10"},[$,(s(!0),n(w,null,S(l.options,r=>(s(),n("option",{value:r.value,key:r.value,innerHTML:r.name},null,8,q))),128))],512),[[E,t.form.Type]]),[1,3].includes(t.form.Type)&&!t.preimport?(s(),n("input",{key:0,class:B({unchecked:!t.form.Alert}),checked:t.form.Alert,type:"checkbox",name:"specific"},null,10,U)):a("",!0),[1,3].includes(t.form.Type)&&!t.preimport?(s(),n("label",{key:1,title:"Show in a popup to other users when they view this prescription.",class:"mb-10",onClick:e[2]||(e[2]=r=>t.form.Alert=!t.form.Alert),for:"specific"},X)):a("",!0),t.preimport&&!t.editing&&t.form.Type!=4?(s(),n("label",Y,[f("Reference Number "),F])):a("",!0),t.preimport&&!t.editing&&t.form.Type==4?(s(),n("label",H,[f("Subscription ID "),j])):a("",!0),t.preimport&&!t.editing&&t.form.Type!=4?h((s(),n("input",{key:4,class:"form-control tBoxSize02 mb-10",name:"reference-number","onUpdate:modelValue":e[3]||(e[3]=r=>t.form.ReferenceNumber=r),type:"text"},null,512)),[[c,t.form.ReferenceNumber]]):a("",!0),t.preimport&&!t.editing&&t.form.Type==4?h((s(),n("input",{key:5,class:"form-control tBoxSize02 mb-10",name:"reference-number","onUpdate:modelValue":e[4]||(e[4]=r=>t.form.Subscription=r),type:"text"},null,512)),[[c,t.form.Subscription]]):a("",!0),Q,D(d,{id:"note",modelValue:t.form.Note,"onUpdate:modelValue":e[5]||(e[5]=r=>t.form.Note=r)},null,8,["modelValue"]),t.error!=""?(s(),n("div",G,[o("p",null,I(this.error),1)])):a("",!0)],32)]),o("div",J,[o("button",{onClick:e[7]||(e[7]=r=>l.close()),class:"btn btnSize01 secondaryBtn bigButton"}," Cancel "),t.form.Type!=0&&t.form.Note!=""&&!t.editing?(s(),n("button",{key:0,onClick:e[8]||(e[8]=r=>l.submit()),class:"btn btnSize01 primaryBtn"}," Save ")):t.editing?(s(),n("button",{key:1,onClick:e[9]||(e[9]=r=>l.update()),class:"btn btnSize01 primaryBtn"}," Update ")):a("",!0)]),o("span",{class:"backdrop-toggle",onClick:e[10]||(e[10]=r=>l.toggleBackdrop()),title:"Unfocus the modal"},W),o("span",{class:"close",onClick:e[11]||(e[11]=r=>l.close()),title:"Close the modal"},x)])])):a("",!0)]),_:1})}const se=y(R,[["render",ee]]);export{se as default};
//# sourceMappingURL=NoteModal-yODNQRYU.js.map
