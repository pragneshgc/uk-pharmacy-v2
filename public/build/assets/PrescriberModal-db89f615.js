import d from"./Modal-76bda924.js";import{V as m}from"./vue2-editor.esm-3249ef74.js";import{n as u,E as p}from"./app-a3e6dddd.js";import{D as v}from"./vuejs-datepicker.esm-72f1c627.js";const g={props:["orderID"],mixins:[p],extends:d,components:{VueEditor:m,Datepicker:v},data:function(){return{prescriberForm:{options:[{name:"[REJECT] Too many ordered",value:1,limit:30},{name:"[REJECT] Dosage problem",value:2,limit:30},{name:"[QUERY] Miscellaneous",value:4,limit:30},{name:"[QUERY] Dosage problem",value:5,limit:30},{name:"[QUERY] Potential name discrepancy",value:6,limit:0}],select:0,message:"",date:""},disabledDates:{to:new Date,days:[6,0]},errors:[],loading:!1,backdrop:!0}},watch:{"prescriberForm.select":function(){this.prescriberForm.select!=3&&(this.prescriberForm.date="")},"show.modal":function(){setTimeout(()=>{this.show.modal&&!this.dragEventTriggered&&document.getElementById("draggable-div-prescriber")?(function(e){var t=0,s=0,o=0,a=0;document.getElementById("draggable-div-header-prescriber")?document.getElementById("draggable-div-header-prescriber").onmousedown=n:e.onmousedown=n;function n(r){r=r||window.event,r.preventDefault(),o=r.clientX,a=r.clientY,document.onmouseup=c,document.onmousemove=l}function l(r){r=r||window.event,r.preventDefault(),t=o-r.clientX,s=a-r.clientY,o=r.clientX,a=r.clientY,e.style.top=e.offsetTop-s+"px",e.style.left=e.offsetLeft-t+"px"}function c(){document.onmouseup=null,document.onmousemove=null}}(document.getElementById("draggable-div-prescriber")),this.dragEventTriggered=!0):(this.dragEventTriggered=!1,this.backdrop=!0)},500)}},methods:{submit(){this.loading=!0,axios.post("/mail/"+this.orderID+"/contact",{form:this.prescriberForm}).then(i=>{this.postSuccess(i.data.message),this.$root.$emit("tray.remove",this.orderID),this.resetForm(),this.show.modal=!1}).catch(i=>{this.errors.push(i.response.data.message),this.postError(i.response.data.message)}).finally(()=>{this.loading=!1})},toggleBackdrop(){this.backdrop=!this.backdrop},resetForm(){this.prescriberForm.select=0,this.prescriberForm.message="",this.prescriberForm.date="",this.errors=[]}}};var b=function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"fade"}},[e.show.modal?t("div",{staticClass:"esa-modal"},[e.backdrop?t("div",{staticClass:"backdrop",on:{click:function(s){return e.close()}}}):e._e(),t("div",{staticClass:"modal",attrs:{id:"draggable-div-prescriber"}},[t("transition",{attrs:{name:"fade"}},[t("div",{directives:[{name:"show",rawName:"v-show",value:e.loading,expression:"loading"}],staticClass:"loader"},[e._v("Loading...")])]),t("div",{staticClass:"modal-header draggable-div-header",attrs:{id:"draggable-div-header-prescriber"}},[t("h3",[e._v("Send Message")])]),t("div",{staticClass:"modal-body"},[t("form",{on:{submit:function(s){return e.submit()}}},[t("label",{attrs:{for:"message-select"}},[e._v("Email template "),t("small",{staticClass:"danger"},[e._v("(required)")])]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.prescriberForm.select,expression:"prescriberForm.select"}],staticClass:"table-dropdown mb-10",attrs:{name:"message-select"},on:{change:function(s){var o=Array.prototype.filter.call(s.target.options,function(a){return a.selected}).map(function(a){var n="_value"in a?a._value:a.value;return n});e.$set(e.prescriberForm,"select",s.target.multiple?o:o[0])}}},[t("option",{attrs:{value:"0",disabled:""}},[e._v("Please select a template")]),e._l(e.prescriberForm.options,function(s){return t("option",{key:s.value,domProps:{value:s.value}},[e._v(e._s(s.name))])})],2),e.prescriberForm.select==3?t("div",{staticClass:"mb-10"},[t("label",{attrs:{for:"message-date"}},[e._v("New date "),t("small",{staticClass:"danger"},[e._v("(required)")])]),t("datepicker",{attrs:{name:"return-date","disabled-dates":e.disabledDates,maxlength:"30"},model:{value:e.prescriberForm.date,callback:function(s){e.$set(e.prescriberForm,"date",s)},expression:"prescriberForm.date"}})],1):e._e(),t("label",{attrs:{for:"message-text"}},[e._v("Message "),t("small",{staticClass:"danger"},[e._v("(required)")])]),t("vue-editor",{model:{value:e.prescriberForm.message,callback:function(s){e.$set(e.prescriberForm,"message",s)},expression:"prescriberForm.message"}}),e.errors.length>0?t("div",{staticClass:"infoBox error"},e._l(e.errors,function(s,o){return t("p",{key:o},[e._v(" "+e._s(s)+" ")])}),0):e._e()],1)]),t("div",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btnSize01 secondaryBtn bigButton",attrs:{disabled:e.loading},on:{click:function(s){return e.close()}}},[e._v(" Cancel ")]),t("button",{staticClass:"btn btnSize01 primaryBtn",attrs:{disabled:e.loading},on:{click:function(s){return e.submit()}}},[e._v(" Submit ")])]),t("span",{staticClass:"backdrop-toggle",attrs:{title:"Unfocus the modal"},on:{click:function(s){return e.toggleBackdrop()}}},[t("i",{staticClass:"fa fa-clone"})]),t("span",{staticClass:"close",attrs:{title:"Close the modal"},on:{click:function(s){return e.close()}}},[t("i",{staticClass:"fa fa-close"})])],1)]):e._e()])},f=[],h=u(g,b,f,!1,null,null,null,null);const k=h.exports;export{k as default};
