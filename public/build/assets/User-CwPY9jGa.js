import{_ as w,E as S,o,c as i,a,D as C,w as n,B as c,t as d,b as l,A as h,F as m,f,g as _,m as y,j as g,K as k,T as U}from"./app-CzB2aCin.js";const V={mixins:[S],data:function(){return{data:{},esaUsers:{},apps:{},password:null,passwordFieldVisible:!1,passwordSecurityStatus:!1,code:"",emailFieldVisible:!1,loginCodeVisible:!1,loading:!1,errors:{},userInfo,roles:{}}},mounted(){this.userInfo.id!=this.$route.params.id&&this.userInfo.role<50?this.$router.push("/notallowed"):(this.getData(),this.getPasswordSecurityStatus())},computed:{tableUrl:function(){return"/inventory/user/"+this.$route.params.id},dataUrl:function(){return"/users/"+this.$route.params.id},postUrl:function(){return"/users/"+this.$route.params.id},loginAsUrl:function(){return"/login_as/"+this.$route.params.id}},methods:{getData:function(){console.log("get data"),this.loading=!0,axios.get(this.dataUrl).then(e=>{this.data=e.data.data.userData,this.esaUsers=e.data.data.esaUsers,this.roles=e.data.data.appRoles,this.apps=e.data.data.apps,this.loading=!1}).catch(e=>{this.reportError(e)})},getPasswordSecurityStatus:function(e){axios.get(`/users/${this.$route.params.id}/2fa-status`).then(t=>{this.passwordSecurityStatus=t.data.data,this.passwordSecurityStatus&&axios.get(`/users/${this.$route.params.id}/2fa-code`).then(p=>{this.code=p.data.data})}).catch(t=>{this.reportError(t)})},enable2fa:function(){axios.post(`/users/${this.$route.params.id}/2fa-enable`).then(()=>{this.getPasswordSecurityStatus()}).catch(e=>{this.reportError(e)})},disable2fa:function(){axios.post(`/users/${this.$route.params.id}/2fa-disable`).then(()=>{this.getPasswordSecurityStatus()}).catch(e=>{this.reportError(e)})},togglePasswordChange:function(){this.passwordFieldVisible=!this.passwordFieldVisible},toggleEmailChange:function(){this.emailFieldVisible=!this.emailFieldVisible},toggleLoginCodeChange:function(){this.loginCodeVisible=!this.loginCodeVisible},update:function(){this.loading=!0;let e={name:this.data.name,surname:this.data.surname,email:this.data.email,inventory_role_id:this.data.inventory_role_id,shipping_role_id:this.data.shipping_role_id,pharmacy_role_id:this.data.pharmacy_role_id,default_app:this.data.default_app,code:this.data.code,esa_user_id:this.data.esa_user_id};this.password&&(e.password=this.password),axios.post(this.postUrl,e).then(t=>{this.postSuccess(t.data.message),this.errors={},this.loading=!1}).catch(t=>{this.errors=t.response.data.errors,this.loading=!1})},loginAs:function(){axios.get(this.loginAsUrl).then(e=>{location.reload()}).catch(e=>{console.warn(e)})},generateCode(e){for(var t="",p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789$%()[]?!:@/",v=p.length,b=0;b<e;b++)t+=p.charAt(Math.floor(Math.random()*v));return t},storeCode(){this.data.code=this.generateCode(14)}}},B={class:"content"},z={class:"card"},E=a("div",{class:"card-header"},[a("h3",null,"User details")],-1),F={class:"card-body"},A=a("h4",{class:"h4 mb-3"},"User details",-1),D={style:{display:"flex","justify-content":"space-evenly"}},I={style:{display:"flex","flex-direction":"column",width:"30%"}},P=a("label",null,"Name",-1),L={key:0,class:"invalid-feedback d-block"},T=a("label",null,"Surname",-1),M={key:1,class:"invalid-feedback d-block"},N={style:{display:"flex","flex-direction":"column",width:"30%"}},R={key:0},j=["value"],$={key:2,class:"invalid-feedback d-block"},G={style:{display:"flex","flex-direction":"column",width:"30%"}},H={key:0},K={key:1},Q={key:0},q=["innerHTML"],J=["src"],O=a("p",null,"This QR code can be scanned by an authenticator app to start using it.",-1),W=a("h4",{class:"h4 mb-3"},"Role details",-1),X={style:{display:"flex","justify-content":"space-evenly"}},Y={style:{display:"flex","flex-direction":"column",width:"30%"}},Z=a("label",null,"Pharmacy Role",-1),x=["value"],ee={key:0,class:"invalid-feedback d-block"},se={style:{display:"flex","flex-direction":"column",width:"30%"}},te=a("label",null,"Inventory Role",-1),ae=["value"],oe={key:1,class:"invalid-feedback d-block"},ie={style:{display:"flex","flex-direction":"column",width:"30%"}},le=a("label",null,"Shipping Role",-1),re=["value"],de={key:2,class:"invalid-feedback d-block"},ne={style:{display:"flex","justify-content":"space-evenly"}},ue={style:{display:"flex","flex-direction":"column",width:"30%"}},pe=a("label",null,"Default Application",-1),ce=["value"],he={key:0,class:"invalid-feedback d-block"},me={key:1,class:"invalid-feedback d-block"},fe={key:0,class:"input-group mb-3"},be={class:"input-group-append",style:{display:"inline"}},ye={key:1,class:"invalid-feedback d-block"},ge=a("br",null,null,-1),ve={key:1,class:"invalid-feedback d-block"},_e=a("button",{class:"btn btnSize01 secondaryBtn",type:"submit"},"Update",-1);function ke(e,t,p,v,b,r){return o(),i("div",B,[a("section",z,[E,a("div",F,[a("form",{class:"text-center p-5",onSubmit:t[17]||(t[17]=C((...s)=>r.update&&r.update(...s),["prevent"]))},[A,a("div",D,[a("div",I,[P,n(a("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>e.data.name=s),type:"text",id:"name",class:"form-control tBoxSize02 mb-10",placeholder:"Name"},null,512),[[c,e.data.name]]),e.errors.name?(o(),i("div",L,d(e.errors.name[0]),1)):l("",!0),T,n(a("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>e.data.surname=s),type:"text",id:"surname",class:"form-control tBoxSize02 mb-10",placeholder:"Surname"},null,512),[[c,e.data.surname]]),e.errors.surname?(o(),i("div",M,d(e.errors.surname[0]),1)):l("",!0)]),a("div",N,[e.userInfo.role>=50?(o(),i("label",R,"ESA User")):l("",!0),e.userInfo.role>=50?n((o(),i("select",{key:1,"onUpdate:modelValue":t[2]||(t[2]=s=>e.data.esa_user_id=s),class:"browser-default custom-select mb-10"},[(o(!0),i(m,null,f(e.esaUsers,s=>(o(),i("option",{value:s.UserID},d(s.Username),9,j))),256))],512)),[[h,e.data.esa_user_id]]):l("",!0),e.errors.esa_user_id?(o(),i("div",$,d(e.errors.esa_user_id[0]),1)):l("",!0)]),a("div",G,[a("p",null,[_("2FA is Currently "),e.passwordSecurityStatus?(o(),i("b",H,"Enabled")):(o(),i("b",K,"Disabled")),_(" for this account.")]),e.passwordSecurityStatus?(o(),i("div",Q,[e.code.type=="svg"?(o(),i("div",{key:0,innerHTML:e.code.code},null,8,q)):(o(),i("img",{key:1,src:e.code.code,alt:"barcode"},null,8,J)),O])):l("",!0)])]),W,a("div",X,[a("div",Y,[Z,n(a("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>e.data.pharmacy_role_id=s),class:"browser-default custom-select"},[(o(!0),i(m,null,f(e.roles.Pharmacy,(s,u)=>(o(),i("option",{value:s.id,key:u},d(s.name),9,x))),128))],512),[[h,e.data.pharmacy_role_id]])]),e.errors.role?(o(),i("div",ee,d(e.errors.role[0]),1)):l("",!0),a("div",se,[te,n(a("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>e.data.inventory_role_id=s),class:"browser-default custom-select"},[(o(!0),i(m,null,f(e.roles.Inventory,(s,u)=>(o(),i("option",{value:s.id,key:u},d(s.name),9,ae))),128))],512),[[h,e.data.inventory_role_id]])]),e.errors.inventory_role?(o(),i("div",oe,d(e.errors.role[0]),1)):l("",!0),a("div",ie,[le,n(a("select",{"onUpdate:modelValue":t[5]||(t[5]=s=>e.data.shipping_role_id=s),class:"browser-default custom-select"},[(o(!0),i(m,null,f(e.roles.Inventory,(s,u)=>(o(),i("option",{value:s.id,key:u},d(s.name),9,re))),128))],512),[[h,e.data.shipping_role_id]])]),e.errors.shipping_role?(o(),i("div",de,d(e.errors.shipping_role[0]),1)):l("",!0)]),a("div",ne,[a("div",ue,[pe,n(a("select",{"onUpdate:modelValue":t[6]||(t[6]=s=>e.data.default_app=s),class:"browser-default custom-select"},[(o(!0),i(m,null,f(e.apps,(s,u)=>(o(),i("option",{value:u,key:u},d(s),9,ce))),128))],512),[[h,e.data.default_app]])]),e.errors.default_app?(o(),i("div",he,d(e.errors.default_app[0]),1)):l("",!0)]),y(k,{name:"fade"},{default:g(()=>[e.passwordFieldVisible?n((o(),i("input",{key:0,autocomplete:"off","onUpdate:modelValue":t[7]||(t[7]=s=>e.password=s),type:"password",name:"new-password",id:"password",class:"form-control tBoxSize02 mb-3",placeholder:"Password"},null,512)),[[c,e.password]]):l("",!0),e.errors.password?(o(),i("div",me,d(e.errors.password[0]),1)):l("",!0)]),_:1}),y(U,{name:"fade"},{default:g(()=>[a("div",null,[e.loginCodeVisible?(o(),i("div",fe,[n(a("input",{style:{margin:"0!important"},autocomplete:"off","onUpdate:modelValue":t[8]||(t[8]=s=>e.data.code=s),type:"code",name:"code",id:"code",class:"form-control tBoxSize02 mb-10",placeholder:"Login Code"},null,512),[[c,e.data.code]]),a("div",be,[a("button",{onClick:t[9]||(t[9]=s=>r.storeCode()),class:"btn btnSize01 secondaryBtn m-0 z-depth-0 waves-effect",type:"button",id:"button-addon2"},"Generate Code")])])):l("",!0),e.errors.code?(o(),i("div",ye,d(e.errors.code[0]),1)):l("",!0)])]),_:1}),ge,y(k,{name:"fade"},{default:g(()=>[e.emailFieldVisible?n((o(),i("input",{key:0,"onUpdate:modelValue":t[10]||(t[10]=s=>e.data.email=s),type:"email",id:"email",class:"form-control tBoxSize02 mb-10",placeholder:"E-mail"},null,512)),[[c,e.data.email]]):l("",!0),e.errors.email?(o(),i("div",ve,d(e.errors.email[0]),1)):l("",!0)]),_:1}),a("div",null,[a("button",{onClick:t[11]||(t[11]=(...s)=>r.togglePasswordChange&&r.togglePasswordChange(...s)),class:"btn btnSize01 secondaryBtn",type:"button"},"Change password"),a("button",{onClick:t[12]||(t[12]=(...s)=>r.toggleEmailChange&&r.toggleEmailChange(...s)),class:"btn btnSize01 secondaryBtn",type:"button"},"Change email"),a("button",{onClick:t[13]||(t[13]=(...s)=>r.toggleLoginCodeChange&&r.toggleLoginCodeChange(...s)),class:"btn btnSize01 secondaryBtn",type:"button"},"Change login code"),e.passwordSecurityStatus?l("",!0):(o(),i("button",{key:0,onClick:t[14]||(t[14]=(...s)=>r.enable2fa&&r.enable2fa(...s)),class:"btn btnSize01 secondaryBtn",type:"button"},"Enable 2FA")),e.passwordSecurityStatus?(o(),i("button",{key:1,onClick:t[15]||(t[15]=(...s)=>r.disable2fa&&r.disable2fa(...s)),class:"btn btnSize01 secondaryBtn",type:"button"},"Disable 2FA")):l("",!0),e.userInfo.role==60?(o(),i("button",{key:2,onClick:t[16]||(t[16]=(...s)=>r.loginAs&&r.loginAs(...s)),class:"btn btnSize01 secondaryBtn",type:"button"},"Login as user")):l("",!0),_e])],32)])])])}const Se=w(V,[["render",ke]]);export{Se as default};
//# sourceMappingURL=User-CwPY9jGa.js.map
