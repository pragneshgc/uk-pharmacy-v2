import{n as l,E as n}from"./app-a3e6dddd.js";const d={mixins:[n],data:function(){return{data:{},esaUsers:{},apps:{},password:null,passwordFieldVisible:!1,passwordSecurityStatus:!1,code:"",emailFieldVisible:!1,loginCodeVisible:!1,loading:!1,errors:{},userInfo}},mounted(){userInfo.id!=this.$route.params.id&&userInfo.role<50?this.$router.push("/notallowed"):(this.getData(),this.getPasswordSecurityStatus())},computed:{tableUrl:function(){return"/inventory/user/"+this.$route.params.id},dataUrl:function(){return"/users/"+this.$route.params.id},postUrl:function(){return"/users/"+this.$route.params.id},loginAsUrl:function(){return"/login_as/"+this.$route.params.id}},methods:{getData:function(){this.loading=!0,axios.get(this.dataUrl).then(i=>{this.data=i.data.data.userData,this.esaUsers=i.data.data.esaUsers,this.roles=i.data.data.appRoles,this.apps=i.data.data.apps,this.loading=!1}).catch(i=>{this.reportError(i)})},getPasswordSecurityStatus:function(i){axios.get(`/users/${this.$route.params.id}/2fa-status`).then(e=>{this.passwordSecurityStatus=e.data.data,this.passwordSecurityStatus&&axios.get(`/users/${this.$route.params.id}/2fa-code`).then(t=>{this.code=t.data.data})}).catch(e=>{this.reportError(e)})},enable2fa:function(){axios.post(`/users/${this.$route.params.id}/2fa-enable`).then(()=>{this.getPasswordSecurityStatus()}).catch(i=>{this.reportError(i)})},disable2fa:function(){axios.post(`/users/${this.$route.params.id}/2fa-disable`).then(()=>{this.getPasswordSecurityStatus()}).catch(i=>{this.reportError(i)})},togglePasswordChange:function(){this.passwordFieldVisible=!this.passwordFieldVisible},toggleEmailChange:function(){this.emailFieldVisible=!this.emailFieldVisible},toggleLoginCodeChange:function(){this.loginCodeVisible=!this.loginCodeVisible},update:function(){this.loading=!0;let i={name:this.data.name,surname:this.data.surname,email:this.data.email,inventory_role_id:this.data.inventory_role_id,shipping_role_id:this.data.shipping_role_id,pharmacy_role_id:this.data.pharmacy_role_id,default_app:this.data.default_app,code:this.data.code,esa_user_id:this.data.esa_user_id};this.password&&(i.password=this.password),axios.post(this.postUrl,i).then(e=>{this.postSuccess(e.data.message),this.errors={},this.loading=!1}).catch(e=>{this.errors=e.response.data.errors,this.loading=!1})},loginAs:function(){axios.get(this.loginAsUrl).then(i=>{location.reload()}).catch(i=>{console.warn(i)})},generateCode(i){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789$%()[]?!:@/",a=t.length,r=0;r<i;r++)e+=t.charAt(Math.floor(Math.random()*a));return e},storeCode(){this.data.code=this.generateCode(14)}}};var c=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[t("section",{staticClass:"card"},[e._m(0),t("div",{staticClass:"card-body"},[t("form",{staticClass:"text-center p-5",on:{submit:function(a){return a.preventDefault(),e.update.apply(null,arguments)}}},[t("h4",{staticClass:"h4 mb-3"},[e._v("User details")]),t("div",{staticStyle:{display:"flex","justify-content":"space-evenly"}},[t("div",{staticStyle:{display:"flex","flex-direction":"column",width:"30%"}},[t("label",[e._v("Name")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.data.name,expression:"data.name"}],staticClass:"form-control tBoxSize02 mb-10",attrs:{type:"text",id:"name",placeholder:"Name"},domProps:{value:e.data.name},on:{input:function(a){a.target.composing||e.$set(e.data,"name",a.target.value)}}}),e.errors.name?t("div",{staticClass:"invalid-feedback d-block"},[e._v(e._s(e.errors.name[0]))]):e._e(),t("label",[e._v("Surname")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.data.surname,expression:"data.surname"}],staticClass:"form-control tBoxSize02 mb-10",attrs:{type:"text",id:"surname",placeholder:"Surname"},domProps:{value:e.data.surname},on:{input:function(a){a.target.composing||e.$set(e.data,"surname",a.target.value)}}}),e.errors.surname?t("div",{staticClass:"invalid-feedback d-block"},[e._v(e._s(e.errors.surname[0]))]):e._e()]),t("div",{staticStyle:{display:"flex","flex-direction":"column",width:"30%"}},[e.userInfo.role>=50?t("label",[e._v("ESA User")]):e._e(),e.userInfo.role>=50?t("select",{directives:[{name:"model",rawName:"v-model",value:e.data.esa_user_id,expression:"data.esa_user_id"}],staticClass:"browser-default custom-select mb-10",on:{change:function(a){var r=Array.prototype.filter.call(a.target.options,function(s){return s.selected}).map(function(s){var o="_value"in s?s._value:s.value;return o});e.$set(e.data,"esa_user_id",a.target.multiple?r:r[0])}}},e._l(e.esaUsers,function(a){return t("option",{domProps:{value:a.UserID}},[e._v(e._s(a.Username))])}),0):e._e(),e.errors.esa_user_id?t("div",{staticClass:"invalid-feedback d-block"},[e._v(e._s(e.errors.esa_user_id[0])+" ")]):e._e()]),t("div",{staticStyle:{display:"flex","flex-direction":"column",width:"30%"}},[t("p",[e._v("2FA is Currently "),e.passwordSecurityStatus?t("b",[e._v("Enabled")]):t("b",[e._v("Disabled")]),e._v(" for this account.")]),e.passwordSecurityStatus?t("div",[e.code.type=="svg"?[t("div",{domProps:{innerHTML:e._s(e.code.code)}})]:[t("img",{attrs:{src:e.code.code,alt:"barcode"}})],t("p",[e._v("This QR code can be scanned by an authenticator app to start using it.")])],2):e._e()])]),t("h4",{staticClass:"h4 mb-3"},[e._v("Role details")]),t("div",{staticStyle:{display:"flex","justify-content":"space-evenly"}},[t("div",{staticStyle:{display:"flex","flex-direction":"column",width:"30%"}},[t("label",[e._v("Pharmacy Role")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.data.pharmacy_role_id,expression:"data.pharmacy_role_id"}],staticClass:"browser-default custom-select",on:{change:function(a){var r=Array.prototype.filter.call(a.target.options,function(s){return s.selected}).map(function(s){var o="_value"in s?s._value:s.value;return o});e.$set(e.data,"pharmacy_role_id",a.target.multiple?r:r[0])}}},e._l(e.roles.Pharmacy,function(a,r){return t("option",{key:r,domProps:{value:a.id}},[e._v(" "+e._s(a.name)+" ")])}),0)]),e.errors.role?t("div",{staticClass:"invalid-feedback d-block"},[e._v(e._s(e.errors.role[0]))]):e._e(),t("div",{staticStyle:{display:"flex","flex-direction":"column",width:"30%"}},[t("label",[e._v("Inventory Role")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.data.inventory_role_id,expression:"data.inventory_role_id"}],staticClass:"browser-default custom-select",on:{change:function(a){var r=Array.prototype.filter.call(a.target.options,function(s){return s.selected}).map(function(s){var o="_value"in s?s._value:s.value;return o});e.$set(e.data,"inventory_role_id",a.target.multiple?r:r[0])}}},e._l(e.roles.Inventory,function(a,r){return t("option",{key:r,domProps:{value:a.id}},[e._v(" "+e._s(a.name)+" ")])}),0)]),e.errors.inventory_role?t("div",{staticClass:"invalid-feedback d-block"},[e._v(e._s(e.errors.role[0]))]):e._e(),t("div",{staticStyle:{display:"flex","flex-direction":"column",width:"30%"}},[t("label",[e._v("Shipping Role")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.data.shipping_role_id,expression:"data.shipping_role_id"}],staticClass:"browser-default custom-select",on:{change:function(a){var r=Array.prototype.filter.call(a.target.options,function(s){return s.selected}).map(function(s){var o="_value"in s?s._value:s.value;return o});e.$set(e.data,"shipping_role_id",a.target.multiple?r:r[0])}}},e._l(e.roles.Inventory,function(a,r){return t("option",{key:r,domProps:{value:a.id}},[e._v(" "+e._s(a.name)+" ")])}),0)]),e.errors.shipping_role?t("div",{staticClass:"invalid-feedback d-block"},[e._v(e._s(e.errors.shipping_role[0])+" ")]):e._e()]),t("div",{staticStyle:{display:"flex","justify-content":"space-evenly"}},[t("div",{staticStyle:{display:"flex","flex-direction":"column",width:"30%"}},[t("label",[e._v("Default Application")]),t("select",{directives:[{name:"model",rawName:"v-model",value:e.data.default_app,expression:"data.default_app"}],staticClass:"browser-default custom-select",on:{change:function(a){var r=Array.prototype.filter.call(a.target.options,function(s){return s.selected}).map(function(s){var o="_value"in s?s._value:s.value;return o});e.$set(e.data,"default_app",a.target.multiple?r:r[0])}}},e._l(e.apps,function(a,r){return t("option",{key:r,domProps:{value:r}},[e._v(" "+e._s(a)+" ")])}),0)]),e.errors.default_app?t("div",{staticClass:"invalid-feedback d-block"},[e._v(e._s(e.errors.default_app[0]))]):e._e()]),t("transition",{attrs:{name:"fade"}},[e.passwordFieldVisible?t("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],staticClass:"form-control tBoxSize02 mb-3",attrs:{autocomplete:"off",type:"password",name:"new-password",id:"password",placeholder:"Password"},domProps:{value:e.password},on:{input:function(a){a.target.composing||(e.password=a.target.value)}}}):e._e(),e.errors.password?t("div",{staticClass:"invalid-feedback d-block"},[e._v(e._s(e.errors.password[0]))]):e._e()]),t("transition",{attrs:{name:"fade"}},[t("div",[e.loginCodeVisible?t("div",{staticClass:"input-group mb-3"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.data.code,expression:"data.code"}],staticClass:"form-control tBoxSize02 mb-10",staticStyle:{margin:"0!important"},attrs:{autocomplete:"off",type:"code",name:"code",id:"code",placeholder:"Login Code"},domProps:{value:e.data.code},on:{input:function(a){a.target.composing||e.$set(e.data,"code",a.target.value)}}}),t("div",{staticClass:"input-group-append",staticStyle:{display:"inline"}},[t("button",{staticClass:"btn btnSize01 secondaryBtn m-0 z-depth-0 waves-effect",attrs:{type:"button",id:"button-addon2"},on:{click:function(a){return e.storeCode()}}},[e._v("Generate Code")])])]):e._e(),e.errors.code?t("div",{staticClass:"invalid-feedback d-block"},[e._v(e._s(e.errors.code[0]))]):e._e()])]),t("br"),t("transition",{attrs:{name:"fade"}},[e.emailFieldVisible?t("input",{directives:[{name:"model",rawName:"v-model",value:e.data.email,expression:"data.email"}],staticClass:"form-control tBoxSize02 mb-10",attrs:{type:"email",id:"email",placeholder:"E-mail"},domProps:{value:e.data.email},on:{input:function(a){a.target.composing||e.$set(e.data,"email",a.target.value)}}}):e._e(),e.errors.email?t("div",{staticClass:"invalid-feedback d-block"},[e._v(e._s(e.errors.email[0]))]):e._e()]),t("div",[t("button",{staticClass:"btn btnSize01 secondaryBtn",attrs:{type:"button"},on:{click:e.togglePasswordChange}},[e._v("Change password")]),t("button",{staticClass:"btn btnSize01 secondaryBtn",attrs:{type:"button"},on:{click:e.toggleEmailChange}},[e._v("Change email")]),t("button",{staticClass:"btn btnSize01 secondaryBtn",attrs:{type:"button"},on:{click:e.toggleLoginCodeChange}},[e._v("Change login code")]),e.passwordSecurityStatus?e._e():t("button",{staticClass:"btn btnSize01 secondaryBtn",attrs:{type:"button"},on:{click:e.enable2fa}},[e._v("Enable 2FA")]),e.passwordSecurityStatus?t("button",{staticClass:"btn btnSize01 secondaryBtn",attrs:{type:"button"},on:{click:e.disable2fa}},[e._v("Disable 2FA")]):e._e(),e.userInfo.role==60?t("button",{staticClass:"btn btnSize01 secondaryBtn",attrs:{type:"button"},on:{click:e.loginAs}},[e._v("Login as user")]):e._e(),t("button",{staticClass:"btn btnSize01 secondaryBtn",attrs:{type:"submit"}},[e._v("Update")])])],1)])])])},u=[function(){var i=this,e=i._self._c;return e("div",{staticClass:"card-header"},[e("h3",[i._v("User details")])])}],p=l(d,c,u,!1,null,null,null,null);const v=p.exports;export{v as default};
